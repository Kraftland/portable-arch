# Maintainer: Kimiblock Moe

pkgbase=wps-office-cn-portable
pkgname=wps-office-cn-portable
pkgver=12.1.2.24722.portable
pkgrel=1
pkgdesc="Kingsoft Office (WPS Office) CN version - an office productivity suite"
makedepends+=(desktop-file-utils "wps-office-cn" "portable")
arch=('x86_64')
license=('LicenseRef-WPS-EULA')
url="https://linux.wps.cn"
options=('!emptydirs')
replaces+=(wps-office-cn-bwrap)
conflicts=('kingsoft-office' 'wps-office' "wps-office-cn" wps-office-cn-bwrap)

source=("portable-config" "wps-helper" wps-office-wps.desktop)
sha1sums=('de19eb2efaf516d222defb61117ef2e345afe86c'
          '3e8ddf69528f05eb4004962eddea2014e25ab44f'
          '63bd9f86898f53eb8455443e59a9f8afc6cdbd75')

package() {
	depends+=('fontconfig' 'xorg-mkfontscale' 'libxrender' 'desktop-file-utils' 'shared-mime-info' 'xdg-utils' 'glu' 'sdl2' 'libpulse' 'hicolor-icon-theme' 'libxss' 'sqlite' 'libtool' 'libxslt' 'libjpeg-turbo')
    optdepends=('cups: Printing support'
                'libjpeg-turbo: JPEG image codec support'
                'pango: for complex (right-to-left) text support'
                'curl: An URL retrieval utility and library'
                'ttf-wps-fonts: Symbol fonts required by wps-office'
                'ttf-ms-fonts: Microsft Fonts recommended for wps-office'
                'wps-office-fonts: FZ TTF fonts provided by wps community'
                'wps-office-mui-zh-cn: zh_CN support for WPS Office')

	install -vDm755 "/usr/bin/wps" -t "${pkgdir}/usr/lib/portable/overlay-usr"

	declare -x -g pkgdir
	declare -x -g pkgname
	declare -x -g srcdir
	portable-packer \
		-v \
		--distro arch \
		--mode copy wps-office-cn \
		--hash true \
		--config "${srcdir}/portable-config" \
		--desktop-file "${srcdir}/wps-office-wps.desktop"
	install -vDm755 "${srcdir}/wps-helper" -t "${pkgdir}/usr/bin"
}
